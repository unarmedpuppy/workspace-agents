# Skill Patterns

Best practices for designing and implementing skills in {{PROJECT_NAME}}.

## Overview

Skills are executable, deterministic actions that follow the Anthropic Skills Specification. This reference covers patterns for creating effective skills.

## Skill Structure

```
skill-name/
├── SKILL.md              # Documentation with YAML frontmatter (required)
├── package.json          # Dependencies and scripts
├── scripts/              # Executable implementations
│   ├── command-one.js    # Main command
│   └── command-two.js    # Additional commands
├── references/           # Deep documentation (loaded on demand)
│   └── spec.md           # Detailed specifications
└── assets/               # Output templates
    └── template.md       # Generated file templates
```

## YAML Frontmatter

Every skill requires YAML frontmatter in SKILL.md:

```yaml
---
name: skill-name
description: Brief description. Use when [context for invocation].
---
```

**Required fields**:
- `name`: Hyphen-case, max 64 characters, matches directory name
- `description`: Must include "when to use" context

**Optional fields**:
- `license`: SPDX identifier (e.g., "MIT", "Apache-2.0")
- `allowed-tools`: List of tools the skill may use
- `metadata`: Custom key-value pairs

## Description Pattern

Always include invocation context:

```markdown
# Good
description: Create implementation plans. Use when starting new features, complex changes, or multi-phase work.

# Bad
description: Create implementation plans.
```

The "Use when" clause helps agents decide when to invoke the skill.

## Progressive Disclosure

Structure skill documentation in layers:

**Layer 1: Frontmatter** (always loaded)
```yaml
name: skill-name
description: Brief with "when to use"
```

**Layer 2: SKILL.md** (loaded when relevant)
- Overview
- Commands with examples
- Troubleshooting

**Layer 3: references/** (loaded on demand)
- Detailed specifications
- Extended examples
- Implementation notes

Keep SKILL.md under 500 lines. Move deep documentation to references/.

## Command Patterns

### Single Command Skills

For skills with one primary action:

```markdown
## Usage

\`\`\`bash
cd agents/skills/skill-name
npm run execute [arguments]
\`\`\`
```

### Multi-Command Skills

For skills with multiple actions:

```markdown
## Commands

### Command One

\`\`\`bash
npm run command-one [arguments]
\`\`\`

### Command Two

\`\`\`bash
npm run command-two [arguments]
\`\`\`
```

## Script Patterns

### JavaScript Implementation

```javascript
#!/usr/bin/env node
const fs = require('fs');
const path = require('path');

async function main() {
  const args = process.argv.slice(2);

  // Validate inputs
  if (!args[0]) {
    console.error('Usage: node script.js <argument>');
    process.exit(1);
  }

  // Execute action
  try {
    await performAction(args[0]);
    console.log('✓ Action completed');
  } catch (error) {
    console.error('✗ Error:', error.message);
    process.exit(1);
  }
}

main();
```

### Exit Codes

Use consistent exit codes:
- `0`: Success
- `1`: Error (validation failed, action failed)
- `2`: Warning (non-critical issues)

### User Feedback

Provide clear feedback during execution:

```javascript
console.log('✓ Step completed');      // Success
console.log('⚠ Warning: ...');        // Warning
console.error('✗ Error: ...');        // Error
```

## Validation Patterns

Include validation in all skills:

```javascript
function validateInput(value) {
  const errors = [];
  const warnings = [];

  if (!value) {
    errors.push('Value is required');
  }

  if (value.length > 100) {
    warnings.push('Value is unusually long');
  }

  return { errors, warnings, isValid: errors.length === 0 };
}
```

## Template Patterns

When generating files, use template literals:

```javascript
const template = `---
name: ${name}
created: ${new Date().toISOString().split('T')[0]}
---

# ${title}

${description}
`;

fs.writeFileSync(outputPath, template);
```

Or use separate template files in `assets/`:

```javascript
const template = fs.readFileSync(
  path.join(__dirname, '../assets/template.md'),
  'utf8'
);
const output = template
  .replace(/{{NAME}}/g, name)
  .replace(/{{DATE}}/g, date);
```

## Skills vs Other Resources

**Skills** (this pattern):
- Executable actions
- Deterministic outputs
- Scripts with entry points
- Example: "Create a plan file"

**Personas** (`agents/personas/`):
- Behavioral guidance
- Contextual decisions
- No executable code
- Example: "How to approach planning"

**Reference docs** (`agents/reference/`):
- Static documentation
- Deep topic coverage
- No executable code
- Example: "Plan structure specification"

## Best Practices

1. **Keep SKILL.md focused**: Under 500 lines, move details to references/
2. **Include "when to use"**: Help agents decide when to invoke
3. **Provide examples**: Show expected inputs and outputs
4. **Handle errors gracefully**: Clear messages, appropriate exit codes
5. **Use hyphen-case**: For skill names and file names
6. **No auxiliary files**: No README.md or CHANGELOG.md in skill directories
7. **Validate inputs**: Check all user-provided values
8. **Give feedback**: Show progress during execution

## Creating New Skills

Use the skill-creator skill:

```bash
cd agents/skills/skill-creator
npm run init
```

See [../skills/skill-creator/](../skills/skill-creator/) for complete documentation.

---

*Generated by workspace-agents v{{FRAMEWORK_VERSION}} on {{CREATION_DATE}}*
